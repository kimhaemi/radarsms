<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout/default_layout"
      th:with="metaTitle='전체 감시'">

	<th:block layout:fragment="content">
        <script th:inline="javascript">
            /* <![CDATA[ */
                var group = /*[[${list.groupName}]]*/;
                console.log(group);
                var links = /*[[${list.links}]]*/;
                console.log(links);
            /* ]]> */
        </script>

        <script type="text/javascript">
        $(function() {
            $('.toggle').toggles();
            $('.toggle').on('toggle', function (e, active) {
                var vs=e.target.id.split("_");
                var tf=active?1:0;
        
                // $.post("/manage/sms_target_group_member_sendstep.do", {mid:vs[1],gid:vs[2],step:vs[0],activate:tf}, function(data,status){
                //     if(data.result<1){
                //         var n = noty({
                //             text:'문자전송상태 변환에 실패하였습니다.',
                //             type:'error',
                //             closeWith:['click'],
                //             layout:'center',
                //             modal:true,
                //             callback : {
                //                 afterClose: function(){
                //                     location.reload();
                //                 }
                //             }
                //         });
                //     }
                // });
        
            });
            $('a.btn').button();
            $('input.back').click(function(e){
                window.location.href = "/manage/sms_target_group";
            });
        });
        </script>
    
        <table class="noticeTbl settingSeries" >
            <thead>
            <tr>
                <th class="left">
                    관리 > 문자 수신 그룹 관리 > [ <span th:text="${list.groupName }"></span> ] 그룹 멤버 관리
                </th>
                <th class="right">
                    <input type="button" class="back" value="그룹관리로 돌아가기"/>
                </th>
            </tr>
            </thead>
        </table>

        <table class="mainTbl settingSeries" summary="">
            <caption class="hidden">그룹 관리</caption>
            <colgroup>
                <col style="width:80px" />
                <col style="width:100px" />
                <col style="width:120px" />
                <col style="width:200px" />
                <col />
                <col />
                <col />
                <col />
                <!-- <col /> -->
                <col />
                <col style="width:120px" />
            </colgroup>
            <thead>
                <tr>
                    <th colspan="10">
                        <span th:text="${list.groupName }"></span> 그룹에 속한 사용자
                    </th>
                </tr>
                <tr>
                    <th rowspan="2">성명</th>
                    <th rowspan="2">직책</th>
                    <th rowspan="2">부서</th>
                    <th rowspan="2">소속</th>
                    <th rowspan="2">연락처</th>
                    <th colspan="3">단계별 문자 전송</th>
                    <th rowspan="2">문자 전송</th>
                    <th rowspan="2">삭제</th>
                </tr>
                <tr>
                    <th>주의</th>
                    <th>경고</th>
                    <!-- <th>네트워크</th> -->
                    <th>복구</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="link : ${list.links}">
                    <td>
                        <span th:text="${link.name }"></span>
                    </td>
                    <td>
                        <span th:text="${link.position }"></span>
                    </td>
                    <td>
                        <span th:text="${link.department }"></span>
                    </td>
                    <td>
                        <span th:text="${link.organization }"></span>
                    </td>
                    <td>
                        <span th:text="${link.phone_num }">
                    </td>
                    <td>
                        <div class="toggle toggle-light" th:id="${'noti_'+link.mid+'_'+link.gid}" th:data-toggle-on="${link.noti}"></div>
                    </td>
                    <td>
                        <div class="toggle toggle-light" th:id="${'warn_'+link.mid+'_'+link.gid}" th:data-toggle-on="${link.warn}"></div>
                    </td>
                    <!-- <td>
                        <div class="toggle toggle-light" id="tota_${link.mid }_${link.gid}" data-toggle-on="${link.tota }"></div>
                    </td> -->
                    <td>
                        <div class="toggle toggle-light" th:id="${'retr_'+link.mid+'_'+link.gid}" th:data-toggle-on="${link.retr}"></div>
                    </td>
                    <td>
                        <div class="toggle toggle-light" th:id="${'sms_'+link.mid+'_'+link.gid}" th:data-toggle-on="${link.sms}"></div>
                    </td>
                    <td>
                        <a class="btn" th:href="@{/manage/sms_target_group_member_unlink(gid=${list.groupId})(mid=${link.mid})}">연결 삭제</a>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <table class="mainTbl settingSeries" summary="">
            <caption class="hidden">그룹 관리</caption>
            <colgroup>
                <col style="width:90px" />
                <col style="width:120px" />
                <col style="width:120px" />
                <col style="width:200px" />
                <col />
                <col style="width:140px" />
            </colgroup>
            <thead>
                <tr>
                    <th colspan="6">
                        <span th:text="${list.groupName }"></span> 그룹에 속하지 않은 사용자
                    </th>
                </tr>
                <tr>
                    <th>성명</th>
                    <th>직책</th>
                    <th>부서</th>
                    <th>소속</th>
                    <th>연락처</th>
                    <th>삭제</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="notLink : ${list.notlinks}">
                    <td>
                        <span th:text="${notLink.name }"></span>
                    </td>
                    <td>
                        <span th:text="${notLink.position }"></span>
                    </td>
                    <td>
                        <span th:text="${notLink.department }"></span>
                    </td>
                    <td>
                        <span th:text="${notLink.organization }"></span>
                    </td>
                    <td>
                        <span th:text="${notLink.phone_num }"></span>
                    </td>
                    <td>
                        <a class="btn" href="/manage/sms_target_group_member_mklink.do?gid=${list.groupId }&mid=${notLink.mid}">연결 추가</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </th:block>
</html>